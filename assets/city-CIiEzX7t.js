import{c as ie,e as ce,r as Ge,d as Z,u as Je,a as i,m as G,n as X,t as Ie,h as de,y as F,I as ae,w as re,ah as le,ai as ye,aj as Qe,ak as Ze,W as et,M as tt,U as Pe,q,al as Be,am as nt,b as j,f as Te,F as at,an as lt,k as ke,C as ne,D as Me,v as _e,ao as Ve,ap as ot,p as oe,K as $e,aq as it,ar as ct,as as rt,at as st,G as ut,R as dt,au as ft,a2 as xe,_ as Ce,x as gt,av as ht,Q as Ae,aa as mt,a9 as vt,aw as bt,a3 as D,a4 as Y,a7 as fe,ax as ue,H as J,ad as ee,ac as Re,ae as me,z as yt,A as kt,ab as _t,a5 as xt,a6 as Ct}from"./index-B0opCrll.js";import{a as ge,u as It}from"./index-_9sP_Wb0.js";import{u as St}from"./city-B_nPOTKH.js";import{u as Oe,T as wt,a as Tt}from"./index-CnF-cnGh.js";import{_ as Vt}from"./_plugin-vue_export-helper-DlAUqK2U.js";const[At,Q]=ie("cell"),pe={tag:G("div"),icon:String,size:String,title:X,value:X,label:X,center:Boolean,isLink:Boolean,border:Ie,iconPrefix:String,valueClass:de,labelClass:de,titleClass:de,titleStyle:null,arrowDirection:String,required:{type:[Boolean,String],default:null},clickable:{type:Boolean,default:null}},Rt=ce({},pe,Ge);var Et=Z({name:At,props:Rt,setup(e,{slots:n}){const a=Je(),g=()=>{if(n.label||F(e.label))return i("div",{class:[Q("label"),e.labelClass]},[n.label?n.label():e.label])},o=()=>{var l;if(n.title||F(e.title)){const m=(l=n.title)==null?void 0:l.call(n);return Array.isArray(m)&&m.length===0?void 0:i("div",{class:[Q("title"),e.titleClass],style:e.titleStyle},[m||i("span",null,[e.title]),g()])}},d=()=>{const l=n.value||n.default;if(l||F(e.value))return i("div",{class:[Q("value"),e.valueClass]},[l?l():i("span",null,[e.value])])},S=()=>{if(n.icon)return n.icon();if(e.icon)return i(ae,{name:e.icon,class:Q("left-icon"),classPrefix:e.iconPrefix},null)},y=()=>{if(n["right-icon"])return n["right-icon"]();if(e.isLink){const l=e.arrowDirection&&e.arrowDirection!=="right"?`arrow-${e.arrowDirection}`:"arrow";return i(ae,{name:l,class:Q("right-icon")},null)}};return()=>{var l;const{tag:m,size:r,center:T,border:V,isLink:M,required:z}=e,I=(l=e.clickable)!=null?l:M,A={center:T,required:!!z,clickable:I,borderless:!V};return r&&(A[r]=!!r),i(m,{class:Q(A),role:I?"button":void 0,tabindex:I?0:void 0,onClick:a},{default:()=>{var $;return[S(),o(),d(),y(),($=n.extra)==null?void 0:$.call(n)]}})}}});const De=re(Et);function ze(e){return Array.isArray(e)?!e.length:e===0?!1:!e}function Lt(e,n){if(ze(e)){if(n.required)return!1;if(n.validateEmpty===!1)return!0}return!(n.pattern&&!n.pattern.test(String(e)))}function Pt(e,n){return new Promise(a=>{const g=n.validator(e,n);if(Qe(g)){g.then(a);return}a(g)})}function Ee(e,n){const{message:a}=n;return Ze(a)?a(e,n):a||""}function Bt({target:e}){e.composing=!0}function Le({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function Mt(e,n){const a=le();e.style.height="auto";let g=e.scrollHeight;if(et(n)){const{maxHeight:o,minHeight:d}=n;o!==void 0&&(g=Math.min(g,o)),d!==void 0&&(g=Math.max(g,d))}g&&(e.style.height=`${g}px`,ye(a))}function $t(e){return e==="number"?{type:"text",inputmode:"decimal"}:e==="digit"?{type:"tel",inputmode:"numeric"}:{type:e}}function W(e){return[...e].length}function ve(e,n){return[...e].slice(0,n).join("")}const[Ot,B]=ie("field"),Se={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:X,formatter:Function,clearIcon:G("clear"),modelValue:tt(""),inputAlign:String,placeholder:String,autocomplete:String,autocapitalize:String,autocorrect:String,errorMessage:String,enterkeyhint:String,clearTrigger:G("focus"),formatTrigger:G("onChange"),spellcheck:{type:Boolean,default:null},error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null}},pt=ce({},pe,Se,{rows:X,type:G("text"),rules:Array,autosize:[Boolean,Object],labelWidth:X,labelClass:de,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var Dt=Z({name:Ot,props:pt,emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:a}){const g=Oe(),o=Pe({status:"unvalidated",focused:!1,validateMessage:""}),d=q(),S=q(),y=q(),{parent:l}=Be(nt),m=()=>{var t;return String((t=e.modelValue)!=null?t:"")},r=t=>{if(F(e[t]))return e[t];if(l&&F(l.props[t]))return l.props[t]},T=j(()=>{const t=r("readonly");if(e.clearable&&!t){const s=m()!=="",u=e.clearTrigger==="always"||e.clearTrigger==="focus"&&o.focused;return s&&u}return!1}),V=j(()=>y.value&&a.input?y.value():e.modelValue),M=j(()=>{var t;const s=r("required");return s==="auto"?(t=e.rules)==null?void 0:t.some(u=>u.required):s}),z=t=>t.reduce((s,u)=>s.then(()=>{if(o.status==="failed")return;let{value:v}=V;if(u.formatter&&(v=u.formatter(v,u)),!Lt(v,u)){o.status="failed",o.validateMessage=Ee(v,u);return}if(u.validator)return ze(v)&&u.validateEmpty===!1?void 0:Pt(v,u).then(_=>{_&&typeof _=="string"?(o.status="failed",o.validateMessage=_):_===!1&&(o.status="failed",o.validateMessage=Ee(v,u))})}),Promise.resolve()),I=()=>{o.status="unvalidated",o.validateMessage=""},A=()=>n("endValidate",{status:o.status,message:o.validateMessage}),$=(t=e.rules)=>new Promise(s=>{I(),t?(n("startValidate"),z(t).then(()=>{o.status==="failed"?(s({name:e.name,message:o.validateMessage}),A()):(o.status="passed",s(),A())})):s()}),N=t=>{if(l&&e.rules){const{validateTrigger:s}=l.props,u=Ve(s).includes(t),v=e.rules.filter(_=>_.trigger?Ve(_.trigger).includes(t):u);v.length&&$(v)}},H=t=>{var s;const{maxlength:u}=e;if(F(u)&&W(t)>+u){const v=m();if(v&&W(v)===+u)return v;const _=(s=d.value)==null?void 0:s.selectionEnd;if(o.focused&&_){const w=[...t],p=w.length-+u;return w.splice(_-p,p),w.join("")}return ve(t,+u)}return t},x=(t,s="onChange")=>{const u=t;t=H(t);const v=W(u)-W(t);if(e.type==="number"||e.type==="digit"){const w=e.type==="number";t=ot(t,w,w)}let _=0;if(e.formatter&&s===e.formatTrigger){const{formatter:w,maxlength:p}=e;if(t=w(t),F(p)&&W(t)>+p&&(t=ve(t,+p)),d.value&&o.focused){const{selectionEnd:se}=d.value,we=ve(u,se);_=W(w(we))-W(we)}}if(d.value&&d.value.value!==t)if(o.focused){let{selectionStart:w,selectionEnd:p}=d.value;if(d.value.value=t,F(w)&&F(p)){const se=W(t);v?(w-=v,p-=v):_&&(w+=_,p+=_),d.value.setSelectionRange(Math.min(w,se),Math.min(p,se))}}else d.value.value=t;t!==e.modelValue&&n("update:modelValue",t)},c=t=>{t.target.composing||x(t.target.value)},E=()=>{var t;return(t=d.value)==null?void 0:t.blur()},R=()=>{var t;return(t=d.value)==null?void 0:t.focus()},f=()=>{const t=d.value;e.type==="textarea"&&e.autosize&&t&&Mt(t,e.autosize)},h=t=>{o.focused=!0,n("focus",t),ne(f),r("readonly")&&E()},b=t=>{o.focused=!1,x(m(),"onBlur"),n("blur",t),!r("readonly")&&(N("onBlur"),ne(f),ct())},C=t=>n("clickInput",t),k=t=>n("clickLeftIcon",t),L=t=>n("clickRightIcon",t),K=t=>{oe(t),n("update:modelValue",""),n("clear",t)},P=j(()=>{if(typeof e.error=="boolean")return e.error;if(l&&l.props.showError&&o.status==="failed")return!0}),O=j(()=>{const t=r("labelWidth"),s=r("labelAlign");if(t&&s!=="top")return{width:Te(t)}}),he=t=>{t.keyCode===13&&(!(l&&l.props.submitOnEnter)&&e.type!=="textarea"&&oe(t),e.type==="search"&&E()),n("keypress",t)},U=()=>e.id||`${g}-input`,qe=()=>o.status,We=()=>{const t=B("control",[r("inputAlign"),{error:P.value,custom:!!a.input,"min-height":e.type==="textarea"&&!e.autosize}]);if(a.input)return i("div",{class:t,onClick:C},[a.input()]);const s={id:U(),ref:d,name:e.name,rows:e.rows!==void 0?+e.rows:void 0,class:t,disabled:r("disabled"),readonly:r("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,autocapitalize:e.autocapitalize,autocorrect:e.autocorrect,enterkeyhint:e.enterkeyhint,spellcheck:e.spellcheck,"aria-labelledby":e.label?`${g}-label`:void 0,onBlur:b,onFocus:h,onInput:c,onClick:C,onChange:Le,onKeypress:he,onCompositionend:Le,onCompositionstart:Bt};return e.type==="textarea"?i("textarea",s,null):i("input",$e($t(e.type),s),null)},je=()=>{const t=a["left-icon"];if(e.leftIcon||t)return i("div",{class:B("left-icon"),onClick:k},[t?t():i(ae,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},He=()=>{const t=a["right-icon"];if(e.rightIcon||t)return i("div",{class:B("right-icon"),onClick:L},[t?t():i(ae,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},Ke=()=>{if(e.showWordLimit&&e.maxlength){const t=W(m());return i("div",{class:B("word-limit")},[i("span",{class:B("word-num")},[t]),it("/"),e.maxlength])}},Ue=()=>{if(l&&l.props.showErrorMessage===!1)return;const t=e.errorMessage||o.validateMessage;if(t){const s=a["error-message"],u=r("errorMessageAlign");return i("div",{class:B("error-message",u)},[s?s({message:t}):t])}},Ye=()=>{const t=r("labelWidth"),s=r("labelAlign"),u=r("colon")?":":"";if(a.label)return[a.label(),u];if(e.label)return i("label",{id:`${g}-label`,for:a.input?void 0:U(),onClick:v=>{oe(v),R()},style:s==="top"&&t?{width:Te(t)}:void 0},[e.label+u])},Xe=()=>[i("div",{class:B("body")},[We(),T.value&&i(ae,{ref:S,name:e.clearIcon,class:B("clear")},null),He(),a.button&&i("div",{class:B("button")},[a.button()])]),Ke(),Ue()];return ge({blur:E,focus:R,validate:$,formValue:V,resetValidation:I,getValidationStatus:qe}),at(lt,{customValue:y,resetValidation:I,validateWithTrigger:N}),ke(()=>e.modelValue,()=>{x(m()),I(),N("onChange"),ne(f)}),Me(()=>{x(m(),e.formatTrigger),ne(f)}),_e("touchstart",K,{target:j(()=>{var t;return(t=S.value)==null?void 0:t.$el})}),()=>{const t=r("disabled"),s=r("labelAlign"),u=je(),v=()=>{const _=Ye();return s==="top"?[u,_].filter(Boolean):_||[]};return i(De,{size:e.size,class:B({error:P.value,disabled:t,[`label-${s}`]:s}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:O.value,valueClass:B("value"),titleClass:[B("label",[s,{required:M.value}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:u&&s!=="top"?()=>u:null,title:v,value:Xe,extra:a.extra})}}});const zt=re(Dt);function Nt(){return Array(26).fill("").map((a,g)=>String.fromCharCode(65+g))}const[Ne,be]=ie("index-bar"),Ft={sticky:Ie,zIndex:X,teleport:[String,Object],highlightColor:String,stickyOffsetTop:dt(0),indexList:{type:Array,default:Nt}},Fe=Symbol(Ne);var qt=Z({name:Ne,props:Ft,emits:["select","change"],setup(e,{emit:n,slots:a}){const g=q(),o=q(),d=q(""),S=It(),y=rt(g),{children:l,linkChildren:m}=st(Fe);let r;m({props:e});const T=j(()=>{if(F(e.zIndex))return{zIndex:+e.zIndex+1}}),V=j(()=>{if(e.highlightColor)return{color:e.highlightColor}}),M=(f,h)=>{for(let b=l.length-1;b>=0;b--){const C=b>0?h[b-1].height:0,k=e.sticky?C+e.stickyOffsetTop:0;if(f+k>=h[b].top)return b}return-1},z=f=>l.find(h=>String(h.index)===f),I=()=>{if(ft(g))return;const{sticky:f,indexList:h}=e,b=xe(y.value),C=Ce(y),k=l.map(K=>K.getRect(y.value,C));let L=-1;if(r){const K=z(r);if(K){const P=K.getRect(y.value,C);e.sticky&&e.stickyOffsetTop?L=M(P.top-e.stickyOffsetTop,k):L=M(P.top,k)}}else L=M(b,k);d.value=h[L],f&&l.forEach((K,P)=>{const{state:O,$el:he}=K;if(P===L||P===L-1){const U=he.getBoundingClientRect();O.left=U.left,O.width=U.width}else O.left=null,O.width=null;if(P===L)O.active=!0,O.top=Math.max(e.stickyOffsetTop,k[P].top-b)+C.top;else if(P===L-1&&r===""){const U=k[L].top-b;O.active=U>0,O.top=U+C.top-k[P].height}else O.active=!1}),r=""},A=()=>{ne(I)};_e("scroll",I,{target:y,passive:!0}),Me(A),ke(()=>e.indexList,A),ke(d,f=>{f&&n("change",f)});const $=()=>e.indexList.map(f=>{const h=f===d.value;return i("span",{class:be("index",{active:h}),style:h?V.value:void 0,"data-index":f},[f])}),N=f=>{r=String(f);const h=z(r);if(h){const b=xe(y.value),C=Ce(y),{offsetHeight:k}=document.documentElement;if(h.$el.scrollIntoView(),b===k-C.height){I();return}e.sticky&&e.stickyOffsetTop&&(le()===k-C.height?ye(le()):ye(le()-e.stickyOffsetTop)),n("select",h.index)}},H=f=>{const{index:h}=f.dataset;h&&N(h)},x=f=>{H(f.target)};let c;const E=f=>{if(S.move(f),S.isVertical()){oe(f);const{clientX:h,clientY:b}=f.touches[0],C=document.elementFromPoint(h,b);if(C){const{index:k}=C.dataset;k&&c!==k&&(c=k,H(C))}}},R=()=>i("div",{ref:o,class:be("sidebar"),style:T.value,onClick:x,onTouchstartPassive:S.start},[$()]);return ge({scrollTo:N}),_e("touchmove",E,{target:o}),()=>{var f;return i("div",{ref:g,class:be()},[e.teleport?i(ut,{to:e.teleport},{default:()=>[R()]}):R(),(f=a.default)==null?void 0:f.call(a)])}}});const[Wt,jt]=ie("index-anchor"),Ht={index:X};var Kt=Z({name:Wt,props:Ht,setup(e,{slots:n}){const a=Pe({top:0,left:null,rect:{top:0,height:0},width:null,active:!1}),g=q(),{parent:o}=Be(Fe);if(!o)return;const d=()=>a.active&&o.props.sticky,S=j(()=>{const{zIndex:l,highlightColor:m}=o.props;if(d())return ce(gt(l),{left:a.left?`${a.left}px`:void 0,width:a.width?`${a.width}px`:void 0,transform:a.top?`translate3d(0, ${a.top}px, 0)`:void 0,color:m})});return ge({state:a,getRect:(l,m)=>{const r=Ce(g);return a.rect.height=r.height,l===window||l===document.body?a.rect.top=r.top+le():a.rect.top=r.top+xe(l)-m.top,a.rect}}),()=>{const l=d();return i("div",{ref:g,style:{height:l?`${a.rect.height}px`:void 0}},[i("div",{style:S.value,class:[jt({sticky:l}),{[ht]:l}]},[n.default?n.default():e.index])])}}});const Ut=re(Kt),Yt=re(qt),[Xt,te,Gt]=ie("search"),Jt=ce({},Se,{label:String,shape:G("square"),leftIcon:G("search"),clearable:Ie,actionText:String,background:String,showAction:Boolean});var Qt=Z({name:Xt,props:Jt,emits:["blur","focus","clear","search","cancel","clickInput","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:a,attrs:g}){const o=Oe(),d=q(),S=()=>{a.action||(n("update:modelValue",""),n("cancel"))},y=c=>{c.keyCode===13&&(oe(c),n("search",e.modelValue))},l=()=>e.id||`${o}-input`,m=()=>{if(a.label||e.label)return i("label",{class:te("label"),for:l()},[a.label?a.label():e.label])},r=()=>{if(e.showAction){const c=e.actionText||Gt("cancel");return i("div",{class:te("action"),role:"button",tabindex:0,onClick:S},[a.action?a.action():c])}},T=()=>{var c;return(c=d.value)==null?void 0:c.blur()},V=()=>{var c;return(c=d.value)==null?void 0:c.focus()},M=c=>n("blur",c),z=c=>n("focus",c),I=c=>n("clear",c),A=c=>n("clickInput",c),$=c=>n("clickLeftIcon",c),N=c=>n("clickRightIcon",c),H=Object.keys(Se),x=()=>{const c=ce({},g,Ae(e,H),{id:l()}),E=R=>n("update:modelValue",R);return i(zt,$e({ref:d,type:"search",class:te("field",{"with-message":c.errorMessage}),border:!1,onBlur:M,onFocus:z,onClear:I,onKeypress:y,onClickInput:A,onClickLeftIcon:$,onClickRightIcon:N,"onUpdate:modelValue":E},c),Ae(a,["left-icon","right-icon"]))};return ge({focus:V,blur:T}),()=>{var c;return i("div",{class:te({"show-action":e.showAction}),style:{background:e.background}},[(c=a.left)==null?void 0:c.call(a),i("div",{class:te("content",e.shape)},[m(),x()]),r()])}}});const Zt=re(Qt),en=e=>(xt("data-v-59fd3941"),e=e(),Ct(),e),tn={class:"city"},nn={class:"top"},an={class:"content"},ln=en(()=>fe("div",{class:"text"},"热门",-1)),on={class:"hotlist"},cn=["onClick"],rn=Z({__name:"city",setup(e){const n=St();n.fetchAllCitiesData();const{allCity:a}=mt(n),g=vt(),o=q(""),d=q(0),S=T=>m(),y=()=>l(),l=()=>{g.back()},m=T=>{},r=T=>{n.currentCity=T,g.back()};return(T,V)=>{const M=Zt,z=Tt,I=wt,A=Ut,$=De,N=Yt,H=bt("tempalte");return D(),Y("div",tn,[fe("div",nn,[i(M,{modelValue:o.value,"onUpdate:modelValue":V[0]||(V[0]=x=>o.value=x),shape:"round",background:"#ff9854",placeholder:"城市/区域/位置","show-action":"",onSearch:S,onCancel:y},null,8,["modelValue"]),i(I,{active:d.value,"onUpdate:active":V[1]||(V[1]=x=>d.value=x),sticky:""},{default:ue(()=>[(D(!0),Y(J,null,ee(Re(a),(x,c,E)=>(D(),me(z,{key:E,title:x.title,name:c},null,8,["title","name"]))),128))]),_:1},8,["active"])]),(D(!0),Y(J,null,ee(Re(a),(x,c,E)=>(D(),me(H,{key:E},{default:ue(()=>[yt(fe("div",an,[i(N,{"index-list":T.indexList},{default:ue(()=>[i(A,{index:"热门"},{default:ue(()=>[ln,fe("div",on,[(D(!0),Y(J,null,ee(x.hotCities,(R,f,h)=>(D(),Y("div",{key:h,class:"city",onClick:b=>r(R)},_t(R.cityName),9,cn))),128))])]),_:2},1024),(D(!0),Y(J,null,ee(x.cities,(R,f,h)=>(D(),Y(J,{key:h},[i(A,{index:R.group},null,8,["index"]),(D(!0),Y(J,null,ee(R.cities,(b,C,k)=>(D(),me($,{title:b.cityName,onClick:L=>r(b)},null,8,["title","onClick"]))),256))],64))),128))]),_:2},1032,["index-list"])],512),[[kt,d.value==c]])]),_:2},1024))),128))])}}}),hn=Vt(rn,[["__scopeId","data-v-59fd3941"]]);export{hn as default};
